<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GovCon AI Chat</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh; display: flex; flex-direction: column;
        }
        #chat-container { flex: 1; display: flex; flex-direction: column; max-width: 100%; margin: 0 auto; background: white; height: 100vh; }
        #chat-header {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white; padding: 20px; text-align: center;
        }
        #chat-header h1 { font-size: 1.5rem; font-weight: 600; }
        #chat-messages { flex: 1; overflow-y: auto; padding: 20px; background: #f9fafb; }
        .message { margin-bottom: 16px; display: flex; gap: 12px; }
        .message.user { flex-direction: row-reverse; }
        .message-avatar {
            width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 14px;
        }
        .message.assistant .message-avatar { background: #e5e7eb; color: #374151; }
        .message.user .message-avatar { background: #3b82f6; color: white; }
        .message-content {
            max-width: 80%; padding: 12px 16px; border-radius: 12px; font-size: 14px; line-height: 1.5;
        }
        .message.assistant .message-content { background: white; border: 1px solid #e5e7eb; border-top-left-radius: 4px; }
        .message.user .message-content { background: #3b82f6; color: white; border-top-right-radius: 4px; }
        #chat-input-container { padding: 16px; background: white; border-top: 1px solid #e5e7eb; }
        #chat-input-form { display: flex; gap: 8px; }
        #chat-input { flex: 1; padding: 12px 16px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; outline: none; }
        #chat-input:focus { border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
        #send-button { padding: 12px 24px; background: #3b82f6; color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: background 0.2s; }
        #send-button:hover { background: #2563eb; }
        #send-button:disabled { background: #d1d5db; cursor: not-allowed; }
        .loading { display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: #3b82f6; animation: bounce 1.4s infinite ease-in-out both; }
        .loading:nth-child(1) { animation-delay: -0.32s; }
        .loading:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
    </style>
</head>
<body>
    <div id="chat-container">
        <div id="chat-header">
            <h1>ðŸ¤– GovCon AI Assistant</h1>
            <p style="font-size: 14px; opacity: 0.9; margin-top: 4px;">Ask about SAM.gov, NAICS codes, FEMA opportunities & more</p>
        </div>
        <div id="chat-messages">
            <div class="message assistant">
                <div class="message-avatar">ðŸ¤–</div>
                <div class="message-content">Hi! I'm your GovCon AI assistant. I can help you with SAM.gov opportunities, NAICS codes, FEMA contracts, and proposal strategies. What would you like to know?</div>
            </div>
        </div>
        <div id="chat-input-container">
            <form id="chat-input-form">
                <input type="text" id="chat-input" placeholder="Ask about government contracts..." autocomplete="off">
                <button type="submit" id="send-button">Send</button>
            </form>
            <p style="font-size: 12px; color: #6b7280; text-align: center; margin-top: 8px;">Powered by AI</p>
        </div>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');
        const chatForm = document.getElementById('chat-input-form');

        const demoResponses = {
            'govcon': "GovCon AI is an intelligent platform that monitors SAM.gov 24/7, tracking government contract opportunities across NAICS codes, FEMA programs, and State EMA contracts. We deliver real-time alerts to your Slack and email before your competitors even start searching. Plans start at $97/month with a 14-day free trial.",
            'sam': "We monitor SAM.gov continuously so you don't have to. Our AI scans every new posting, matches opportunities to your NAICS codes and set-aside categories (8(a), HUBZone, SDVOSB, WOSB), and sends you instant Slack and email alerts with full details. Start a 14-day free trial to see live opportunities in your area right now.",
            'naics': "NAICS codes are critical for government contracting â€” contracts are often set aside for specific codes. We track 13+ primary NAICS codes and can help you identify which ones fit your business. Tell me your industry (IT, cybersecurity, construction, consulting, etc.) and I'll share the relevant NAICS codes and current opportunity volume.",
            'fema': "FEMA contracts are a major opportunity area â€” disaster response, emergency management, debris removal, temporary housing, and recovery services. We track FEMA opportunities AND State Emergency Management Agency (EMA) contracts across all 50 states. Our platform alerts you to emergency procurements the moment they're posted â€” speed matters in this space. Start a free trial to see current FEMA opportunities.",
            'cyber': "Cybersecurity is one of the largest federal contracting sectors, with billions in annual spending. Key agencies include DoD, DHS, VA, and the Intelligence Community.\n\nRelevant NAICS codes:\nâ€¢ 541512 â€” Computer Systems Design\nâ€¢ 541519 â€” Other Computer Related Services\nâ€¢ 541690 â€” Scientific & Technical Consulting\nâ€¢ 561621 â€” Security Systems Services\n\nCommon contract types include FISMA compliance, SOC operations, penetration testing, zero-trust architecture, and cloud security. Many are set aside for small businesses.\n\nGovCon AI tracks these automatically â€” start a 14-day free trial to see current cybersecurity opportunities delivered to your Slack and inbox.",
            'it': "Federal IT spending exceeds $100B annually, making it the largest contracting sector. Key NAICS codes:\n\nâ€¢ 541511 â€” Custom Computer Programming\nâ€¢ 541512 â€” Computer Systems Design\nâ€¢ 541513 â€” Computer Facilities Management\nâ€¢ 541519 â€” Other Computer Related Services\nâ€¢ 518210 â€” Cloud Computing & Data Processing\n\nMajor contract vehicles include Alliant 2, SEWP V, CIO-SP3, and GSA IT Schedule 70. We track all of these and deliver matches to you in real-time. Start a free trial to see current IT opportunities.",
            'construction': "Federal construction is a massive market. The Army Corps of Engineers, GSA, and VA are the biggest buyers.\n\nKey NAICS codes:\nâ€¢ 236220 â€” Commercial Building Construction\nâ€¢ 237310 â€” Highway & Street Construction\nâ€¢ 238220 â€” Plumbing, Heating & AC\n\nMany contracts are set aside for small businesses, 8(a), HUBZone, and SDVOSB firms. GovCon AI monitors all new construction solicitations and alerts you instantly. Start a 14-day free trial to see live opportunities.",
            'price': "GovCon Command Center Pricing:\n\nCORE TIERS (All include 14-day free trial):\nâ€¢ Starter â€” $97/month: Automated pipeline tracking, weekly reports, Slack notifications\nâ€¢ Professional â€” $197/month: Daily proposal countdowns, email reminders, Notion dashboards\nâ€¢ Enterprise â€” $397/month: Win/loss analytics, custom reporting, white-glove service\n\nADD-ONS:\nâ€¢ GovCon AI Pro â€” $497/month: AI-powered SAM.gov tracking with intelligent scoring\n\nBUNDLES (Save 14-35%):\nâ€¢ Contractor Essentials â€” $597/month (Save 14%)\nâ€¢ Emergency Response â€” $1,197/month (Save 20%)\nâ€¢ All-Access Pass â€” $3,997/month (Save 35%)\n\nAll plans include 14-day free trial, cancel anytime. Contact info@trapiermanagement.com for custom enterprise pricing.",
            'trial': "All plans include a 14-day free trial with full access to every feature. You'll be able to set up your NAICS codes and keywords, connect Slack or email, and start receiving real-time contract alerts immediately. No charge for the first 14 days â€” you can explore the full platform and see live opportunities before committing.",
            'discount': "Bundle Discounts Available!\n\nâ€¢ Contractor Essentials â€” $597/month (Save 14%): Professional + GovCon AI Pro\nâ€¢ Emergency Response â€” $1,197/month (Save 20%): Professional + GovCon AI Pro + FEMA Command Center\nâ€¢ All-Access Pass â€” $3,997/month (Save 35%): Enterprise + All 4 Modules\n\nAll bundles include the 14-day free trial. Bundle and save instead of buying modules separately!",
            'start': "Getting started takes about 2 minutes: sign up for a free 14-day trial, connect your Slack workspace or email, select your NAICS codes and keywords, and start receiving real-time contract alerts immediately. Choose from Starter ($97/mo), Professional ($197/mo), or Enterprise ($397/mo).",
            'how': "Our AI continuously monitors SAM.gov, FEMA, and State EMA portals. When a new opportunity is posted, we instantly analyze it against your NAICS codes, keywords, and set-aside categories. Matching opportunities are scored, prioritized, and delivered directly to your Slack channel and inbox â€” often before your competitors even know they exist.",
            'proposal': "Winning government contracts requires strong proposals. Key elements:\n\nâ€¢ Technical approach that directly addresses the SOW\nâ€¢ Past performance references with specific metrics\nâ€¢ Compliant pricing structure\nâ€¢ Clear management approach\n\nGovCon AI helps by giving you early notice of opportunities so you have maximum time to prepare. Our Professional tier ($197/mo) includes proposal deadline countdowns and daily reminders. Start a free trial to get ahead of the competition.",
            'small': "Small business set-asides are a huge advantage in government contracting. The government targets 23% of contracts to small businesses.\n\nKey set-aside categories:\nâ€¢ 8(a) Business Development â€” for disadvantaged small businesses\nâ€¢ HUBZone â€” businesses in historically underutilized areas\nâ€¢ SDVOSB â€” service-disabled veteran-owned\nâ€¢ WOSB/EDWOSB â€” women-owned small businesses\n\nGovCon AI filters opportunities by set-aside type so you only see contracts you qualify for. Start a free trial to see what's available for your category.",
            'default': "I can help with any government contracting question! I specialize in:\n\nâ€¢ Finding contracts in your industry (IT, cybersecurity, construction, etc.)\nâ€¢ NAICS codes and set-aside categories\nâ€¢ FEMA and emergency management opportunities\nâ€¢ Pricing and getting started with GovCon AI\nâ€¢ Proposal strategies and compliance\n\nWhat area are you interested in?"
        };

        function getResponse(msg) {
            msg = msg.toLowerCase();
            if (msg.includes('cyber') || msg.includes('security') || msg.includes('infosec')) return demoResponses.cyber;
            if (msg.includes('it ') || msg.includes('technology') || msg.includes('software') || msg.includes('cloud') || msg.includes('computer')) return demoResponses.it;
            if (msg.includes('construct') || msg.includes('building') || msg.includes('engineer')) return demoResponses.construction;
            if (msg.includes('proposal') || msg.includes('bid') || msg.includes('win')) return demoResponses.proposal;
            if (msg.includes('small business') || msg.includes('8(a)') || msg.includes('hubzone') || msg.includes('sdvosb') || msg.includes('wosb') || msg.includes('set-aside') || msg.includes('set aside')) return demoResponses.small;
            if (msg.includes('govcon') || msg.includes('what is') || msg.includes('what do')) return demoResponses.govcon;
            if (msg.includes('sam.gov') || msg.includes('sam ')) return demoResponses.sam;
            if (msg.includes('naics')) return demoResponses.naics;
            if (msg.includes('fema') || msg.includes('emergency') || msg.includes('disaster')) return demoResponses.fema;
            if (msg.includes('discount') || msg.includes('bundle') || msg.includes('save')) return demoResponses.discount;
            if (msg.includes('trial') || msg.includes('free')) return demoResponses.trial;
            if (msg.includes('price') || msg.includes('cost') || msg.includes('pricing') || msg.includes('plan') || msg.includes('much')) return demoResponses.price;
            if (msg.includes('start') || msg.includes('sign') || msg.includes('signup') || msg.includes('begin')) return demoResponses.start;
            if (msg.includes('how') || msg.includes('work')) return demoResponses.how;
            return demoResponses.default;
        }

        chatForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            await sendMessage();
        });

        let conversationHistory = [];

        async function sendMessage() {
            const userMessage = chatInput.value.trim();
            if (!userMessage) return;

            addMessage('user', userMessage);
            chatInput.value = '';
            sendButton.disabled = true;
            addLoadingMessage();

            conversationHistory.push({ role: 'user', content: userMessage });

            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 15000);

                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ messages: conversationHistory }),
                    signal: controller.signal
                });

                clearTimeout(timeoutId);
                removeLoadingMessage();

                if (response.ok) {
                    const data = await response.json();
                    const reply = data.content || data.message || data.response;
                    addMessage('assistant', reply);
                    conversationHistory.push({ role: 'assistant', content: reply });
                    sendButton.disabled = false;
                    chatInput.focus();
                    return;
                }
            } catch (e) {
                // API unavailable â€” use demo fallback
            }

            removeLoadingMessage();
            const demoResponse = getResponse(userMessage);
            addMessage('assistant', demoResponse);
            conversationHistory.push({ role: 'assistant', content: demoResponse });
            sendButton.disabled = false;
            chatInput.focus();
        }

        function addMessage(role, content) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ' + role;
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = role === 'user' ? 'ðŸ‘¤' : 'ðŸ¤–';
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.textContent = content;
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(contentDiv);
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addLoadingMessage() {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message assistant';
            messageDiv.id = 'loading-message';
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = 'ðŸ¤–';
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.innerHTML = '<span class="loading"></span> <span class="loading"></span> <span class="loading"></span>';
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(contentDiv);
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function removeLoadingMessage() {
            const loading = document.getElementById('loading-message');
            if (loading) loading.remove();
        }

        chatInput.focus();
        console.log('Chatbot initialized');
    });
    </script>
</body>
</html>